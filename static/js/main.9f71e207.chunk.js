(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(11),c=(n(20),n(21),n(22),n(2)),a=n(0),s=11619,i=n(3),u=n.n(i),l=n(6),d="https://mate.academy/students-api";function f(e){return new Promise((function(t){setTimeout(t,e)}))}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),f(100).then((function(){return fetch(d+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var b,j=function(e){return p(e)},m=function(e,t){return p(e,"POST",t)},O=function(e,t){return p(e,"PATCH",t)},v=function(e){return p(e,"DELETE")},h=function(e){return v("/todos/".concat(e))},x=function(e){var t=e.id,n=e.userId,r=e.title,o=e.completed;return O("/todos/".concat(t),{userId:n,title:r,completed:o})},T=function(e){var t=e.title,n=e.userId,r=e.completed;return m("/todos",{title:t,userId:n,completed:r})};!function(e){e.TodoLoadError="Unable to load todos",e.TitleError="Title should not be empty",e.AddTodoError="Unable to add a todo",e.DeleteTodoError="Unable to delete a todo",e.UpdateTodoError="Unable to update a todo"}(b||(b={}));var y,k=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j("/todos?userId=".concat(s));case 3:r=e.sent,t.forEach((function(e){return e(r)})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),n(b.TodoLoadError);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),g=n(7),_=n(4),E=n(5),N=n.n(E),w=function(e){var t=e.todos,n=e.allTodos,o=e.setTodos,s=void 0===o?function(){}:o,i=e.setAllTodos,d=void 0===i?function(){}:i,f=e.setErrorMessage,p=void 0===f?function(){}:f,j=e.tempTodo,m=Object(r.useState)(!1),O=Object(c.a)(m,2),v=O[0],T=O[1],y=Object(r.useState)(),k=Object(c.a)(y,2),E=k[0],w=k[1],C=Object(r.useState)(),A=Object(c.a)(C,2),S=A[0],D=A[1],F=Object(r.useState)(""),M=Object(c.a)(F,2),I=M[0],L=M[1],U=Object(r.useRef)(null),P=function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=Object(_.a)(n).map((function(e){if(e.id===t){var n=Object(g.a)(Object(g.a)({},e),{},{completed:!e.completed});try{return x(n),n}catch(r){p(b.UpdateTodoError)}}return e})),d(r),s(r);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),T(!0),e.prev=2,e.next=5,h(t);case 5:d((function(e){return e.filter((function(e){return e.id!==t}))})),s((function(e){return e.filter((function(e){return e.id!==t}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),p(b.DeleteTodoError);case 12:return e.prev=12,T(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(t){return e.apply(this,arguments)}}(),J=function(e,t){w(e),L(t),setTimeout((function(){U.current&&U.current.focus()}),0)},R=function(e){L(e.target.value)},H=function(){var e=Object(l.a)(u.a.mark((function e(n,r){var o,c,a,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===r||void 0===r||r.preventDefault(),o=I.trim()){e.next=5;break}return B(n),e.abrupt("return");case 5:if(n){e.next=7;break}return e.abrupt("return");case 7:if(c=Object(_.a)(t).findIndex((function(e){return e.id===n})),o!==t[c].title){e.next=12;break}return w(void 0),L(""),e.abrupt("return");case 12:return e.prev=12,a=Object(g.a)(Object(g.a)({},t[c]),{},{title:o}),e.next=16,x(a);case 16:i=Object(_.a)(t).map((function(e){return e.id===n?a:e})),d(i),s(i),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(12),p(b.UpdateTodoError);case 24:return e.prev=24,w(void 0),L(""),e.finish(24);case 28:case"end":return e.stop()}}),e,null,[[12,21,24,28]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(a.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[t.map((function(e){var t=e.id,n=e.title,r=e.completed,o=E===t;return Object(a.jsxs)("div",{"data-cy":"Todo",className:N()("todo",{completed:r}),children:[Object(a.jsx)("label",{className:"todo__status-label",children:Object(a.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:r,onChange:function(){return P(t)}})}),o?Object(a.jsx)("form",{onSubmit:function(e){return H(t,e)},children:Object(a.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",value:I,onChange:R,ref:U,onBlur:function(){return H(t)},onKeyDown:function(e){return function(e,t){"Enter"===e.key&&H(t),"Escape"===e.key&&(w(void 0),L(""))}(e,t)}})}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return J(t,n)},children:n}),Object(a.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDelete",onClick:function(){return B(t)},children:"\xd7"})]}),Object(a.jsxs)("div",{"data-cy":"TodoLoader",className:N()("modal overlay",{"is-active":v&&S===t}),children:[Object(a.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(a.jsx)("div",{className:"loader"})]})]},t)})),j&&Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{"data-cy":"Todo",className:N()("todo",{completed:j.completed}),children:[Object(a.jsx)("label",{className:"todo__status-label",children:Object(a.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:j.completed,onChange:function(){return P(j.id)}})}),Object(a.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return J(j.id,j.title)},children:j.title}),Object(a.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDelete",onClick:function(){return B(j.id)},children:"\xd7"}),Object(a.jsxs)("div",{"data-cy":"TodoLoader",className:N()("modal overlay",{"is-active":!0}),children:[Object(a.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(a.jsx)("div",{className:"loader"})]})]},j.id)})]})},C=function(e){var t=e.todos,n=e.allTodos,o=e.setTodos,i=void 0===o?function(){}:o,d=e.setAllTodos,f=void 0===d?function(){}:d,p=e.setErrorMessage,j=void 0===p?function(){}:p,m=Object(r.useState)(""),O=Object(c.a)(m,2),v=O[0],h=O[1],x=Object(r.useState)(!1),y=Object(c.a)(x,2),k=y[0],E=y[1],C=Object(r.useRef)(null),A=Object(r.useState)(null),S=Object(c.a)(A,2),D=S[0],F=S[1];Object(r.useEffect)((function(){C.current&&C.current.focus()}),[k,t]);var M=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.trim()){e.next=4;break}return j(b.TitleError),e.abrupt("return");case 4:return E(!0),F({title:t,completed:!1,userId:s,id:0}),e.prev=6,n={title:t,completed:!1,userId:s},e.next=10,T(n);case 10:r=e.sent,f((function(e){return[].concat(Object(_.a)(e),[r])})),i((function(e){return[].concat(Object(_.a)(e),[r])})),h(""),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),j(b.AddTodoError);case 19:return e.prev=19,F(null),E(!1),e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[6,16,19,23]])})));return function(){return e.apply(this,arguments)}}(),I=function(){var e=Object(l.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0===Object(_.a)(n).filter((function(e){return!e.completed})).length){e.next=10;break}return e.next=5,Promise.all(n.map((function(e){return Object(g.a)(Object(g.a)({},e),{},{completed:!0})})));case 5:t=e.sent,f(t),i(t),e.next=15;break;case 10:return e.next=12,Promise.all(n.map((function(e){return Object(g.a)(Object(g.a)({},e),{},{completed:!1})})));case 12:r=e.sent,f(r),i(r);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),j(b.UpdateTodoError);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("header",{className:"todoapp__header",children:[0!==n.length&&Object(a.jsx)("button",{type:"button","data-cy":"ToggleAllButton",className:N()("todoapp__toggle-all",{active:n.every((function(e){return e.completed}))}),onClick:I}),Object(a.jsx)("form",{onSubmit:function(e){null===e||void 0===e||e.preventDefault(),M()},children:Object(a.jsx)("input",{"data-cy":"NewTodoField",type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:v,onChange:function(e){e.preventDefault(),h(e.target.value)},ref:C,disabled:k})})]}),Object(a.jsx)(w,{todos:t,allTodos:n,setTodos:i,setAllTodos:f,setErrorMessage:j,tempTodo:D})]})};!function(e){e.All="All",e.Completed="Completed",e.Active="Active"}(y||(y={}));var A=function(e){var t=e.allTodos,n=e.setAllTodos,o=void 0===n?function(){}:n,s=e.setTodos,i=void 0===s?function(){}:s,d=e.setErrorMessage,f=void 0===d?function(){}:d,p=e.setQuery,j=void 0===p?function(){}:p,m=Object(r.useState)(y.All),O=Object(c.a)(m,2),v=O[0],x=O[1],T=Object(_.a)(t).filter((function(e){return!e.completed})),k=Object(_.a)(t).filter((function(e){return e.completed})),g=function(e){x(e),j(e)},E=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(k.map((function(e){return h(e.id)})));case 3:i((function(e){return e.filter((function(e){return!e.completed}))})),o((function(e){return e.filter((function(e){return!e.completed}))})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f(b.DeleteTodoError);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(a.jsx)(a.Fragment,{children:!!t.length&&Object(a.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(a.jsx)("span",{className:"todo-count","data-cy":"TodosCounter",children:"".concat(T.length," items left")}),Object(a.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(a.jsx)("a",{href:"#/",className:N()("filter__link",{selected:v===y.All}),onClick:function(){return g(y.All)},"data-cy":"FilterLinkAll",children:"All"}),Object(a.jsx)("a",{href:"#/active",className:N()("filter__link",{selected:v===y.Active}),onClick:function(){return g(y.Active)},"data-cy":"FilterLinkActive",children:"Active"}),Object(a.jsx)("a",{href:"#/completed",className:N()("filter__link",{selected:v===y.Completed}),onClick:function(){return g(y.Completed)},"data-cy":"FilterLinkCompleted",children:"Completed"})]}),Object(a.jsx)("button",{type:"button",className:"todoapp__clear-completed",onClick:E,"data-cy":"ClearCompletedButton",disabled:!k.length,children:"Clear completed"})]})})},S=function(e){var t=e.errorMessage,n=e.setErrorMessage,o=void 0===n?function(){}:n,s=Object(r.useState)(!1),i=Object(c.a)(s,2),u=i[0],l=i[1];Object(r.useEffect)((function(){l(!!t),setTimeout((function(){o(""),l(!1)}),3e3)}),[t]);return Object(a.jsxs)("div",{"data-cy":"ErrorNotification",className:N()("notification is-danger is-light has-text-weight-normal",{hidden:!u}),children:[Object(a.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){o("")}}),t]})},D=function(){var e=Object(r.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],s=Object(r.useState)([]),i=Object(c.a)(s,2),u=i[0],l=i[1],d=Object(r.useState)(""),f=Object(c.a)(d,2),p=f[0],b=f[1],j=Object(r.useState)(y.All),m=Object(c.a)(j,2),O=m[0],v=m[1];Object(r.useEffect)((function(){k([o,l],b)}),[]);var h=function(e,t){switch(t){case"Active":return Object(_.a)(e).filter((function(e){return!1===e.completed}));case"Completed":return Object(_.a)(e).filter((function(e){return!0===e.completed}));default:return Object(_.a)(e)}}(n,O);return Object(a.jsxs)("div",{className:"todoapp",children:[Object(a.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(a.jsxs)("div",{className:"todoapp__content",children:[Object(a.jsx)(C,{todos:h,allTodos:u,setTodos:o,setAllTodos:l,setErrorMessage:b}),Object(a.jsx)(A,{allTodos:u,setAllTodos:l,setTodos:o,setErrorMessage:b,setQuery:v})]}),Object(a.jsx)(S,{errorMessage:p,setErrorMessage:b})]})};Object(o.createRoot)(document.getElementById("root")).render(Object(a.jsx)(D,{}))}},[[25,1,2]]]);
//# sourceMappingURL=main.9f71e207.chunk.js.map